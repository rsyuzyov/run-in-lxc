#!/bin/bash
#
# Ð¡ÐºÑ€Ð¸Ð¿Ñ‚ Ð¾Ñ‚Ð¿Ñ€Ð°Ð²ÐºÐ¸ ÑƒÐ²ÐµÐ´Ð¾Ð¼Ð»ÐµÐ½Ð¸Ð¹ Ð² Telegram Ð¿Ñ€Ð¸ Ð¾Ð±Ð½Ð°Ñ€ÑƒÐ¶ÐµÐ½Ð¸Ð¸ Ð´Ð²Ð¸Ð¶ÐµÐ½Ð¸Ñ
#
# Ð£ÑÑ‚Ð°Ð½Ð¾Ð²ÐºÐ°:
# 1. Ð¡ÐºÐ¾Ð¿Ð¸Ñ€ÑƒÐ¹Ñ‚Ðµ Ð² /usr/local/bin/telegram-notify.sh
# 2. chmod +x /usr/local/bin/telegram-notify.sh
# 3. Ð—Ð°Ð¿Ð¾Ð»Ð½Ð¸Ñ‚Ðµ BOT_TOKEN Ð¸ CHAT_ID
#
# Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð² MotionEye:
# Camera Settings â†’ Motion Notifications â†’ Run A Command:
#   /usr/local/bin/telegram-notify.sh "%camera_name"
#
# ÐŸÐµÑ€ÐµÐ¼ÐµÐ½Ð½Ñ‹Ðµ MotionEye, Ð´Ð¾ÑÑ‚ÑƒÐ¿Ð½Ñ‹Ðµ Ð² ÐºÐ¾Ð¼Ð°Ð½Ð´Ðµ:
#   %camera_name - Ð¸Ð¼Ñ ÐºÐ°Ð¼ÐµÑ€Ñ‹
#   %Y, %m, %d   - Ð³Ð¾Ð´, Ð¼ÐµÑÑÑ†, Ð´ÐµÐ½ÑŒ
#   %H, %M, %S   - Ñ‡Ð°ÑÑ‹, Ð¼Ð¸Ð½ÑƒÑ‚Ñ‹, ÑÐµÐºÑƒÐ½Ð´Ñ‹
#

# ======================
# ÐÐÐ¡Ð¢Ð ÐžÐ™ÐšÐ˜
# ======================

# Ð¢Ð¾ÐºÐµÐ½ Telegram Ð±Ð¾Ñ‚Ð° (Ð¿Ð¾Ð»ÑƒÑ‡Ð¸Ñ‚ÑŒ Ñƒ @BotFather)
BOT_TOKEN="your_bot_token_here"

# ID Ñ‡Ð°Ñ‚Ð° Ð´Ð»Ñ Ð¾Ñ‚Ð¿Ñ€Ð°Ð²ÐºÐ¸ (ÑƒÐ·Ð½Ð°Ñ‚ÑŒ Ñƒ @userinfobot)
CHAT_ID="your_chat_id_here"

# ======================
# ÐšÐžÐ”
# ======================

CAMERA_NAME="${1:-Unknown Camera}"
TIMESTAMP=$(date '+%Y-%m-%d %H:%M:%S')

MESSAGE="ðŸŽ¥ *ÐžÐ±Ð½Ð°Ñ€ÑƒÐ¶ÐµÐ½Ð¾ Ð´Ð²Ð¸Ð¶ÐµÐ½Ð¸Ðµ*
ðŸ“· ÐšÐ°Ð¼ÐµÑ€Ð°: ${CAMERA_NAME}
ðŸ• Ð’Ñ€ÐµÐ¼Ñ: ${TIMESTAMP}"

# ÐžÑ‚Ð¿Ñ€Ð°Ð²ÐºÐ° ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ñ
curl -s -X POST "https://api.telegram.org/bot${BOT_TOKEN}/sendMessage" \
    -d "chat_id=${CHAT_ID}" \
    -d "text=${MESSAGE}" \
    -d "parse_mode=Markdown" \
    > /dev/null 2>&1

exit 0

