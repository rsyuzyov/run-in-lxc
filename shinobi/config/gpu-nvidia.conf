# Настройки GPU для NVIDIA NVENC/NVDEC
# Добавляется в conf.json в секцию ffmpeg

# Для NVIDIA GPU в LXC требуется:
# 1. Установленные драйверы NVIDIA на хосте
# 2. Проброс устройств в контейнер

# Добавьте в /etc/pve/lxc/<ID>.conf:
#
# lxc.cgroup2.devices.allow: c 195:* rwm
# lxc.cgroup2.devices.allow: c 236:* rwm
# lxc.mount.entry: /dev/nvidia0 dev/nvidia0 none bind,optional,create=file
# lxc.mount.entry: /dev/nvidiactl dev/nvidiactl none bind,optional,create=file
# lxc.mount.entry: /dev/nvidia-uvm dev/nvidia-uvm none bind,optional,create=file
# lxc.mount.entry: /dev/nvidia-uvm-tools dev/nvidia-uvm-tools none bind,optional,create=file

# FFmpeg опции для Shinobi:
# "hwaccel": "cuvid"
# "hwaccelDevice": "0"

# Проверка:
# nvidia-smi
# ffmpeg -hwaccels
# ffmpeg -c:v h264_cuvid -i input.mp4 -c:v h264_nvenc output.mp4

